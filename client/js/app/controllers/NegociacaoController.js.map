{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["Bind","DateHelper","NegociacaoService","ListaNegociacao","Negociacao","Mensagem","NegociacaoView","MensagemView","NegociacaoController","_service","listaAll","then","list","forEach","_lista","add","item","catch","_mensagem","texto","error","setInterval","importa","$","document","querySelector","bind","_inputData","_inputValor","_inputQtd","_ordemAtual","_init","event","preventDefault","negociacao","_criaNegociacao","mensagem","_limpaForm","clear","clean","import","negociacoes","lista","coluna","inverte","ordena","textToDate","value","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {Bind} from '../helper/Bind';\r\nimport {DateHelper} from '../helper/DateHelper';\r\n\r\nimport {NegociacaoService} from '../service/NegociacaoService';\r\n\r\nimport {ListaNegociacao} from '../model/ListaNegociacao';\r\nimport {Negociacao} from '../model/Negociacao';\r\nimport {Mensagem} from '../model/Mensagem';\r\n\r\nimport {NegociacaoView} from '../view/NegociacaoView';\r\nimport {MensagemView} from '../view/MensagemView';\r\n\r\nexport class NegociacaoController\r\n      {\r\n            _init()\r\n            {\r\n                this._service.listaAll()\r\n                             .then(list => list.forEach(item=>this._lista.add(item)))\r\n                             .catch(error=>this._mensagem.texto=error)\r\n\r\n                setInterval(()=>this.importa(),3000);\r\n            }\r\n\r\n            constructor()\r\n            {\r\n               let $ = document.querySelector.bind(document);\r\n\r\n               this._inputData   = $(\"#data\");\r\n               this._inputValor  = $(\"#valor\");\r\n               this._inputQtd    = $(\"#quantidade\");\r\n               this._ordemAtual  = '';\r\n\r\n               this._lista    = new Bind(new ListaNegociacao(),new NegociacaoView($(\"#listaNegociacao\")),'add','clean','ordena','inverte');\r\n               this._mensagem = new Bind(new Mensagem(),new MensagemView($(\"#mensagem\")),'texto');\r\n               this._service  = new NegociacaoService();\r\n\r\n               this._init();\r\n            }\r\n\r\n           adiciona(event)\r\n           {\r\n               event.preventDefault();\r\n               let negociacao = this._criaNegociacao();\r\n\r\n               this._service.add(negociacao)\r\n                            .then(mensagem=>{\r\n                               this._lista.add(negociacao);\r\n                               this._mensagem.texto=mensagem;\r\n                               this._limpaForm();\r\n                            })\r\n                            .catch(error=>this._mensagem.texto = error);\r\n          }\r\n\r\n           clear()\r\n           {\r\n               this._service.clear()\r\n                            .then(mensagem => this._mensagem.texto = mensagem)\r\n                            .then(() => this._lista.clean())\r\n                            .catch(error=> this._mensagem.texto = error);\r\n           }\r\n\r\n           importa()\r\n           {\r\n              this._service.import(this._lista.negociacoes)\r\n                     .then(lista=>{ lista.forEach(item=>this._lista.add(item))})\r\n                     .then(()=> this._mensagem.texto = 'Negociações importadas com sucesso')\r\n                     .catch(error=>this._mensagem.texto=error);\r\n           }\r\n\r\n           ordena(coluna)\r\n           {\r\n              if(this._ordemAtual==coluna)\r\n              {\r\n                  this._lista.inverte();\r\n              }\r\n              else\r\n              {\r\n                  this._ordemAtual = coluna;\r\n                  this._lista.ordena(coluna);\r\n              }\r\n           }\r\n\r\n           _criaNegociacao()\r\n           {\r\n               return new Negociacao(\r\n                   DateHelper.textToDate(this._inputData.value),\r\n                   this._inputQtd.value,\r\n                   this._inputValor.value\r\n               );\r\n           }\r\n\r\n           _limpaForm()\r\n           {\r\n               this._inputData.value  = '';\r\n               this._inputQtd.value   = 1;\r\n               this._inputValor.value = 0.0;\r\n               this._inputData.focus();\r\n           }\r\n\r\n      }\r\n"]}